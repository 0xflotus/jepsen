<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>jepsen.checker documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Jepsen</span> <span class="project-version">0.1.7</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>jepsen</span></div></div></li><li class="depth-2 branch"><a href="jepsen.adya.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>adya</span></div></a></li><li class="depth-2 current"><a href="jepsen.checker.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>checker</span></div></a></li><li class="depth-3 branch"><a href="jepsen.checker.perf.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>perf</span></div></a></li><li class="depth-3"><a href="jepsen.checker.timeline.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>timeline</span></div></a></li><li class="depth-2 branch"><a href="jepsen.cli.html"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>cli</span></div></a></li><li class="depth-2 branch"><a href="jepsen.client.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>client</span></div></a></li><li class="depth-2 branch"><a href="jepsen.codec.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>codec</span></div></a></li><li class="depth-2"><a href="jepsen.control.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>control</span></div></a></li><li class="depth-3 branch"><a href="jepsen.control.net.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>net</span></div></a></li><li class="depth-3"><a href="jepsen.control.util.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>util</span></div></a></li><li class="depth-2 branch"><a href="jepsen.core.html"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2 branch"><a href="jepsen.db.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>db</span></div></a></li><li class="depth-2 branch"><a href="jepsen.faketime.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>faketime</span></div></a></li><li class="depth-2 branch"><a href="jepsen.generator.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>generator</span></div></a></li><li class="depth-2 branch"><a href="jepsen.independent.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>independent</span></div></a></li><li class="depth-2"><a href="jepsen.nemesis.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>nemesis</span></div></a></li><li class="depth-3"><a href="jepsen.nemesis.time.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>time</span></div></a></li><li class="depth-2 branch"><a href="jepsen.net.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>net</span></div></a></li><li class="depth-2"><a href="jepsen.os.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>os</span></div></a></li><li class="depth-3"><a href="jepsen.os.debian.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>debian</span></div></a></li><li class="depth-2 branch"><a href="jepsen.reconnect.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>reconnect</span></div></a></li><li class="depth-2 branch"><a href="jepsen.repl.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>repl</span></div></a></li><li class="depth-2 branch"><a href="jepsen.report.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>report</span></div></a></li><li class="depth-2 branch"><a href="jepsen.store.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>store</span></div></a></li><li class="depth-2 branch"><a href="jepsen.tests.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>tests</span></div></a></li><li class="depth-2 branch"><a href="jepsen.util.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>util</span></div></a></li><li class="depth-2"><a href="jepsen.web.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>web</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="jepsen.checker.html#var-check-safe"><div class="inner"><span>check-safe</span></div></a></li><li class="depth-1"><a href="jepsen.checker.html#var-Checker"><div class="inner"><span>Checker</span></div></a></li><li class="depth-2"><a href="jepsen.checker.html#var-check"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>check</span></div></a></li><li class="depth-1"><a href="jepsen.checker.html#var-compose"><div class="inner"><span>compose</span></div></a></li><li class="depth-1"><a href="jepsen.checker.html#var-counter"><div class="inner"><span>counter</span></div></a></li><li class="depth-1"><a href="jepsen.checker.html#var-expand-queue-drain-ops"><div class="inner"><span>expand-queue-drain-ops</span></div></a></li><li class="depth-1"><a href="jepsen.checker.html#var-latency-graph"><div class="inner"><span>latency-graph</span></div></a></li><li class="depth-1"><a href="jepsen.checker.html#var-linearizable"><div class="inner"><span>linearizable</span></div></a></li><li class="depth-1"><a href="jepsen.checker.html#var-merge-valid"><div class="inner"><span>merge-valid</span></div></a></li><li class="depth-1"><a href="jepsen.checker.html#var-perf"><div class="inner"><span>perf</span></div></a></li><li class="depth-1"><a href="jepsen.checker.html#var-queue"><div class="inner"><span>queue</span></div></a></li><li class="depth-1"><a href="jepsen.checker.html#var-rate-graph"><div class="inner"><span>rate-graph</span></div></a></li><li class="depth-1"><a href="jepsen.checker.html#var-set"><div class="inner"><span>set</span></div></a></li><li class="depth-1"><a href="jepsen.checker.html#var-total-queue"><div class="inner"><span>total-queue</span></div></a></li><li class="depth-1"><a href="jepsen.checker.html#var-unbridled-optimism"><div class="inner"><span>unbridled-optimism</span></div></a></li><li class="depth-1"><a href="jepsen.checker.html#var-unique-ids"><div class="inner"><span>unique-ids</span></div></a></li><li class="depth-1"><a href="jepsen.checker.html#var-valid-priorities"><div class="inner"><span>valid-priorities</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">jepsen.checker</h1><div class="doc"><div class="markdown"><p>Validates that a history is correct with respect to some model.</p></div></div><div class="public anchor" id="var-check-safe"><h3>check-safe</h3><div class="usage"><code>(check-safe checker test model history)</code><code>(check-safe checker test model history opts)</code></div><div class="doc"><div class="markdown"><p>Like check, but wraps exceptions up and returns them as a map like</p>
<p>{:valid? :unknown :error “…”}</p></div></div><div class="src-link"><a href="https://github.com/jepsen-io/jepsen/blob/0.1.7/jepsen/src/jepsen/checker.clj#L63">view source</a></div></div><div class="public anchor" id="var-Checker"><h3>Checker</h3><h4 class="type">protocol</h4><div class="usage"></div><div class="doc"><div class="markdown"></div></div><div class="members"><h4>members</h4><div class="inner"><div class="public anchor" id="var-check"><h3>check</h3><div class="usage"><code>(check checker test model history opts)</code></div><div class="doc"><div class="markdown"><p>Verify the history is correct. Returns a map like</p>
<p>{:valid? true}</p>
<p>or</p>
<p>{:valid? false  :some-details …  :failed-at [details of specific operations]}</p>
<p>Opts is a map of options controlling checker execution. Keys include:</p>
<p>:subdirectory - A directory within this test’s store directory where  output files should be written. Defaults to nil.</p></div></div></div></div></div><div class="src-link"><a href="https://github.com/jepsen-io/jepsen/blob/0.1.7/jepsen/src/jepsen/checker.clj#L46">view source</a></div></div><div class="public anchor" id="var-compose"><h3>compose</h3><div class="usage"><code>(compose checker-map)</code></div><div class="doc"><div class="markdown"><p>Takes a map of names to checkers, and returns a checker which runs each check (possibly in parallel) and returns a map of names to results; plus a top-level :valid? key which is true iff every checker considered the history valid.</p></div></div><div class="src-link"><a href="https://github.com/jepsen-io/jepsen/blob/0.1.7/jepsen/src/jepsen/checker.clj#L376">view source</a></div></div><div class="public anchor" id="var-counter"><h3>counter</h3><div class="usage"><code>(counter)</code></div><div class="doc"><div class="markdown"><p>A counter starts at zero; add operations should increment it by that much, and reads should return the present value. This checker validates that at each read, the value is at greater than the sum of all :ok increments, and lower than the sum of all attempted increments.</p>
<p>Note that this counter verifier assumes the value monotonically increases. If you want to increment by negative amounts, you’ll have to recalculate and possibly widen the intervals for all pending reads with each invoke/ok write.</p>
<p>Returns a map:</p>
<p>{:valid? Whether the counter remained within bounds  :reads [[lower-bound read-value upper-bound] …]  :errors [[lower-bound read-value upper-bound] …]  :max-absolute-error The [lower read upper] where read falls furthest outside  :max-relative-error Same, but with error computed as a fraction of the mean}</p></div></div><div class="src-link"><a href="https://github.com/jepsen-io/jepsen/blob/0.1.7/jepsen/src/jepsen/checker.clj#L321">view source</a></div></div><div class="public anchor" id="var-expand-queue-drain-ops"><h3>expand-queue-drain-ops</h3><div class="usage"><code>(expand-queue-drain-ops history)</code></div><div class="doc"><div class="markdown"><p>Takes a history. Looks for :drain operations with their value being a collection of queue elements, and expands them to a sequence of :dequeue invoke/complete pairs.</p></div></div><div class="src-link"><a href="https://github.com/jepsen-io/jepsen/blob/0.1.7/jepsen/src/jepsen/checker.clj#L180">view source</a></div></div><div class="public anchor" id="var-latency-graph"><h3>latency-graph</h3><div class="usage"><code>(latency-graph)</code></div><div class="doc"><div class="markdown"><p>Spits out graphs of latencies.</p></div></div><div class="src-link"><a href="https://github.com/jepsen-io/jepsen/blob/0.1.7/jepsen/src/jepsen/checker.clj#L390">view source</a></div></div><div class="public anchor" id="var-linearizable"><h3>linearizable</h3><div class="usage"><code>(linearizable)</code><code>(linearizable algorithm)</code></div><div class="doc"><div class="markdown"><p>Validates linearizability with Knossos. Defaults to the competition checker, but can be controlled by passing either :linear or :wgl.</p></div></div><div class="src-link"><a href="https://github.com/jepsen-io/jepsen/blob/0.1.7/jepsen/src/jepsen/checker.clj#L82">view source</a></div></div><div class="public anchor" id="var-merge-valid"><h3>merge-valid</h3><div class="usage"><code>(merge-valid valids)</code></div><div class="doc"><div class="markdown"><p>Merge n :valid values, yielding the one with the highest priority.</p></div></div><div class="src-link"><a href="https://github.com/jepsen-io/jepsen/blob/0.1.7/jepsen/src/jepsen/checker.clj#L30">view source</a></div></div><div class="public anchor" id="var-perf"><h3>perf</h3><div class="usage"><code>(perf)</code></div><div class="doc"><div class="markdown"><p>Assorted performance statistics</p></div></div><div class="src-link"><a href="https://github.com/jepsen-io/jepsen/blob/0.1.7/jepsen/src/jepsen/checker.clj#L407">view source</a></div></div><div class="public anchor" id="var-queue"><h3>queue</h3><div class="usage"><code>(queue)</code></div><div class="doc"><div class="markdown"><p>Every dequeue must come from somewhere. Validates queue operations by assuming every non-failing enqueue succeeded, and only OK dequeues succeeded, then reducing the model with that history. Every subhistory of every queue should obey this property. Should probably be used with an unordered queue model, because we don’t look for alternate orderings. O(n).</p></div></div><div class="src-link"><a href="https://github.com/jepsen-io/jepsen/blob/0.1.7/jepsen/src/jepsen/checker.clj#L109">view source</a></div></div><div class="public anchor" id="var-rate-graph"><h3>rate-graph</h3><div class="usage"><code>(rate-graph)</code></div><div class="doc"><div class="markdown"><p>Spits out graphs of throughput over time.</p></div></div><div class="src-link"><a href="https://github.com/jepsen-io/jepsen/blob/0.1.7/jepsen/src/jepsen/checker.clj#L399">view source</a></div></div><div class="public anchor" id="var-set"><h3>set</h3><div class="usage"><code>(set)</code></div><div class="doc"><div class="markdown"><p>Given a set of :add operations followed by a final :read, verifies that every successfully added element is present in the read, and that the read contains only elements for which an add was attempted.</p></div></div><div class="src-link"><a href="https://github.com/jepsen-io/jepsen/blob/0.1.7/jepsen/src/jepsen/checker.clj#L131">view source</a></div></div><div class="public anchor" id="var-total-queue"><h3>total-queue</h3><div class="usage"><code>(total-queue)</code></div><div class="doc"><div class="markdown"><p>What goes in <em>must</em> come out. Verifies that every successful enqueue has a successful dequeue. Queues only obey this property if the history includes draining them completely. O(n).</p></div></div><div class="src-link"><a href="https://github.com/jepsen-io/jepsen/blob/0.1.7/jepsen/src/jepsen/checker.clj#L214">view source</a></div></div><div class="public anchor" id="var-unbridled-optimism"><h3>unbridled-optimism</h3><div class="usage"><code>(unbridled-optimism)</code></div><div class="doc"><div class="markdown"><p>Everything is awesoooommmmme!</p></div></div><div class="src-link"><a href="https://github.com/jepsen-io/jepsen/blob/0.1.7/jepsen/src/jepsen/checker.clj#L76">view source</a></div></div><div class="public anchor" id="var-unique-ids"><h3>unique-ids</h3><div class="usage"><code>(unique-ids)</code></div><div class="doc"><div class="markdown"><p>Checks that a unique id generator actually emits unique IDs. Expects a history with :f :generate invocations matched by :ok responses with distinct IDs for their :values. IDs should be comparable. Returns</p>
<pre><code>{:valid?              Were all IDs unique?
 :attempted-count     Number of attempted ID generation calls
 :acknowledged-count  Number of IDs actually returned successfully
 :duplicated-count    Number of IDs which were not distinct
 :duplicated          A map of some duplicate IDs to the number of times
                      they appeared--not complete for perf reasons :D
 :range               [lowest-id highest-id]}
</code></pre></div></div><div class="src-link"><a href="https://github.com/jepsen-io/jepsen/blob/0.1.7/jepsen/src/jepsen/checker.clj#L273">view source</a></div></div><div class="public anchor" id="var-valid-priorities"><h3>valid-priorities</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>A map of :valid? values to their importance. Larger numbers are considered more signficant and dominate when checkers are composed.</p></div></div><div class="src-link"><a href="https://github.com/jepsen-io/jepsen/blob/0.1.7/jepsen/src/jepsen/checker.clj#L23">view source</a></div></div></div></body></html>