<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>jepsen.control.util documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Jepsen</span> <span class="project-version">0.1.8</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>jepsen</span></div></div></li><li class="depth-2 branch"><a href="jepsen.adya.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>adya</span></div></a></li><li class="depth-2"><a href="jepsen.checker.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>checker</span></div></a></li><li class="depth-3 branch"><a href="jepsen.checker.perf.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>perf</span></div></a></li><li class="depth-3"><a href="jepsen.checker.timeline.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>timeline</span></div></a></li><li class="depth-2 branch"><a href="jepsen.cli.html"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>cli</span></div></a></li><li class="depth-2 branch"><a href="jepsen.client.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>client</span></div></a></li><li class="depth-2 branch"><a href="jepsen.codec.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>codec</span></div></a></li><li class="depth-2"><a href="jepsen.control.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>control</span></div></a></li><li class="depth-3 branch"><a href="jepsen.control.net.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>net</span></div></a></li><li class="depth-3 current"><a href="jepsen.control.util.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>util</span></div></a></li><li class="depth-2 branch"><a href="jepsen.core.html"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2 branch"><a href="jepsen.db.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>db</span></div></a></li><li class="depth-2 branch"><a href="jepsen.faketime.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>faketime</span></div></a></li><li class="depth-2 branch"><a href="jepsen.generator.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>generator</span></div></a></li><li class="depth-2 branch"><a href="jepsen.independent.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>independent</span></div></a></li><li class="depth-2"><a href="jepsen.nemesis.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>nemesis</span></div></a></li><li class="depth-3"><a href="jepsen.nemesis.time.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>time</span></div></a></li><li class="depth-2"><a href="jepsen.net.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>net</span></div></a></li><li class="depth-3"><a href="jepsen.net.proto.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>proto</span></div></a></li><li class="depth-2"><a href="jepsen.os.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>os</span></div></a></li><li class="depth-3"><a href="jepsen.os.debian.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>debian</span></div></a></li><li class="depth-2 branch"><a href="jepsen.reconnect.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>reconnect</span></div></a></li><li class="depth-2 branch"><a href="jepsen.repl.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>repl</span></div></a></li><li class="depth-2 branch"><a href="jepsen.report.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>report</span></div></a></li><li class="depth-2 branch"><a href="jepsen.store.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>store</span></div></a></li><li class="depth-2 branch"><a href="jepsen.tests.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>tests</span></div></a></li><li class="depth-2 branch"><a href="jepsen.util.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>util</span></div></a></li><li class="depth-2"><a href="jepsen.web.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>web</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="jepsen.control.util.html#var-ensure-user.21"><div class="inner"><span>ensure-user!</span></div></a></li><li class="depth-1"><a href="jepsen.control.util.html#var-exists.3F"><div class="inner"><span>exists?</span></div></a></li><li class="depth-1"><a href="jepsen.control.util.html#var-file.3F"><div class="inner"><span>file?</span></div></a></li><li class="depth-1"><a href="jepsen.control.util.html#var-grepkill.21"><div class="inner"><span>grepkill!</span></div></a></li><li class="depth-1"><a href="jepsen.control.util.html#var-install-archive.21"><div class="inner"><span>install-archive!</span></div></a></li><li class="depth-1"><a href="jepsen.control.util.html#var-install-tarball.21"><div class="inner"><span>install-tarball!</span></div></a></li><li class="depth-1"><a href="jepsen.control.util.html#var-ls"><div class="inner"><span>ls</span></div></a></li><li class="depth-1"><a href="jepsen.control.util.html#var-ls-full"><div class="inner"><span>ls-full</span></div></a></li><li class="depth-1"><a href="jepsen.control.util.html#var-start-daemon.21"><div class="inner"><span>start-daemon!</span></div></a></li><li class="depth-1"><a href="jepsen.control.util.html#var-stop-daemon.21"><div class="inner"><span>stop-daemon!</span></div></a></li><li class="depth-1"><a href="jepsen.control.util.html#var-tmp-dir.21"><div class="inner"><span>tmp-dir!</span></div></a></li><li class="depth-1"><a href="jepsen.control.util.html#var-tmp-dir-base"><div class="inner"><span>tmp-dir-base</span></div></a></li><li class="depth-1"><a href="jepsen.control.util.html#var-wget.21"><div class="inner"><span>wget!</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">jepsen.control.util</h1><div class="doc"><div class="markdown"><p>Utility functions for scripting installations.</p></div></div><div class="public anchor" id="var-ensure-user.21"><h3>ensure-user!</h3><div class="usage"><code>(ensure-user! username)</code></div><div class="doc"><div class="markdown"><p>Make sure a user exists.</p></div></div><div class="src-link"><a href="https://github.com/jepsen-io/jepsen/blob/0.1.8/jepsen/src/jepsen/control/util.clj#L150">view source</a></div></div><div class="public anchor" id="var-exists.3F"><h3>exists?</h3><div class="usage"><code>(exists? filename)</code></div><div class="doc"><div class="markdown"><p>Is a path present?</p></div></div><div class="src-link"><a href="https://github.com/jepsen-io/jepsen/blob/0.1.8/jepsen/src/jepsen/control/util.clj#L17">view source</a></div></div><div class="public anchor" id="var-file.3F"><h3>file?</h3><div class="usage"><code>(file? filename)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/jepsen-io/jepsen/blob/0.1.8/jepsen/src/jepsen/control/util.clj#L11">view source</a></div></div><div class="public anchor" id="var-grepkill.21"><h3>grepkill!</h3><div class="usage"><code>(grepkill! pattern)</code><code>(grepkill! signal pattern)</code></div><div class="doc"><div class="markdown"><p>Kills processes by grepping for the given string.</p></div></div><div class="src-link"><a href="https://github.com/jepsen-io/jepsen/blob/0.1.8/jepsen/src/jepsen/control/util.clj#L159">view source</a></div></div><div class="public anchor" id="var-install-archive.21"><h3>install-archive!</h3><div class="usage"><code>(install-archive! url dest)</code><code>(install-archive! url dest force?)</code></div><div class="doc"><div class="markdown"><p>Gets the given tarball URL, caching it in /tmp/jepsen/, and extracts its sole top-level directory to the given dest directory. Deletes current contents of dest. Supports both zip files and tarballs, compressed or raw. Returns dest.</p>
<p>Standard practice for release tarballs is to include a single directory, often named something like foolib-1.2.3-amd64, with files inside it. If only a single directory is present, its <em>contents</em> will be moved to dest, so foolib-1.2.3-amd64/my.file becomes dest/my.file. If the tarball includes multiple files, those files are moved to dest, so my.file becomes dest/my.file.</p></div></div><div class="src-link"><a href="https://github.com/jepsen-io/jepsen/blob/0.1.8/jepsen/src/jepsen/control/util.clj#L72">view source</a></div></div><div class="public anchor" id="var-install-tarball.21"><h3>install-tarball!</h3><div class="usage"><code>(install-tarball! node url dest)</code><code>(install-tarball! node url dest force?)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/jepsen-io/jepsen/blob/0.1.8/jepsen/src/jepsen/control/util.clj#L143">view source</a></div></div><div class="public anchor" id="var-ls"><h3>ls</h3><div class="usage"><code>(ls)</code><code>(ls dir)</code></div><div class="doc"><div class="markdown"><p>A seq of directory entries (not including . and ..). TODO: escaping for control chars in filenames (if you do this, WHO ARE YOU???)</p></div></div><div class="src-link"><a href="https://github.com/jepsen-io/jepsen/blob/0.1.8/jepsen/src/jepsen/control/util.clj#L24">view source</a></div></div><div class="public anchor" id="var-ls-full"><h3>ls-full</h3><div class="usage"><code>(ls-full dir)</code></div><div class="doc"><div class="markdown"><p>Like ls, but prepends dir to each entry.</p></div></div><div class="src-link"><a href="https://github.com/jepsen-io/jepsen/blob/0.1.8/jepsen/src/jepsen/control/util.clj#L32">view source</a></div></div><div class="public anchor" id="var-start-daemon.21"><h3>start-daemon!</h3><div class="usage"><code>(start-daemon! opts bin &amp; args)</code></div><div class="doc"><div class="markdown"><p>Starts a daemon process, logging stdout and stderr to the given file. Invokes <code>bin</code> with <code>args</code>. Options are:</p>
<p>:background? :chdir :logfile :make-pidfile? :match-executable? :match-process-name? :pidfile :process-name</p></div></div><div class="src-link"><a href="https://github.com/jepsen-io/jepsen/blob/0.1.8/jepsen/src/jepsen/control/util.clj#L176">view source</a></div></div><div class="public anchor" id="var-stop-daemon.21"><h3>stop-daemon!</h3><div class="usage"><code>(stop-daemon! pidfile)</code><code>(stop-daemon! cmd pidfile)</code></div><div class="doc"><div class="markdown"><p>Kills a daemon process by pidfile, or, if given a command name, kills all processes with that command name, and cleans up pidfile.</p></div></div><div class="src-link"><a href="https://github.com/jepsen-io/jepsen/blob/0.1.8/jepsen/src/jepsen/control/util.clj#L206">view source</a></div></div><div class="public anchor" id="var-tmp-dir.21"><h3>tmp-dir!</h3><div class="usage"><code>(tmp-dir!)</code></div><div class="doc"><div class="markdown"><p>Creates a temporary directory under /tmp/jepsen and returns its path.</p></div></div><div class="src-link"><a href="https://github.com/jepsen-io/jepsen/blob/0.1.8/jepsen/src/jepsen/control/util.clj#L42">view source</a></div></div><div class="public anchor" id="var-tmp-dir-base"><h3>tmp-dir-base</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>Where should we put temporary files?</p></div></div><div class="src-link"><a href="https://github.com/jepsen-io/jepsen/blob/0.1.8/jepsen/src/jepsen/control/util.clj#L9">view source</a></div></div><div class="public anchor" id="var-wget.21"><h3>wget!</h3><div class="usage"><code>(wget! url)</code><code>(wget! url force?)</code></div><div class="doc"><div class="markdown"><p>Downloads a string URL and returns the filename as a string. Skips if the file already exists.</p></div></div><div class="src-link"><a href="https://github.com/jepsen-io/jepsen/blob/0.1.8/jepsen/src/jepsen/control/util.clj#L52">view source</a></div></div></div></body></html>